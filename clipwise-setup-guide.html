<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClipWise â€” Guia de Setup (5 minutos)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .step { transition: all 0.3s; }
        .step.active { border-color: #9333ea; background: #faf5ff; }
        .step.done { border-color: #22c55e; background: #f0fdf4; }
        .step.done .step-number { background: #22c55e; }
        .copy-btn:active { transform: scale(0.95); }
        code { font-family: 'Menlo', monospace; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

<div class="max-w-3xl mx-auto px-6 py-12">
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900">âœ¦ ClipWise Setup</h1>
        <p class="mt-3 text-lg text-gray-500">5 minutos para colocar seu SaaS no ar</p>
        <div class="mt-4 flex items-center justify-center gap-2">
            <div class="h-2 flex-1 max-w-xs bg-gray-200 rounded-full overflow-hidden">
                <div id="progress-bar" class="h-full bg-purple-600 rounded-full transition-all" style="width: 0%"></div>
            </div>
            <span id="progress-text" class="text-sm text-gray-500">0/5</span>
        </div>
    </div>

    <!-- STEP 1: Supabase -->
    <div class="step active rounded-2xl border-2 border-purple-500 bg-purple-50 p-8 mb-6" id="step-1">
        <div class="flex items-start gap-4">
            <div class="step-number w-10 h-10 rounded-full bg-purple-600 text-white flex items-center justify-center font-bold flex-shrink-0">1</div>
            <div class="flex-1">
                <h2 class="text-xl font-bold text-gray-900">Criar Projeto no Supabase</h2>
                <p class="mt-1 text-gray-600">Banco de dados + autenticaÃ§Ã£o (grÃ¡tis)</p>

                <div class="mt-6 space-y-4">
                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <p class="font-medium text-gray-900">1.1 â€” Abra o Supabase Dashboard</p>
                        <a href="https://supabase.com/dashboard" target="_blank" class="mt-2 inline-block bg-purple-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-500">
                            Abrir Supabase â†’
                        </a>
                    </div>

                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <p class="font-medium text-gray-900">1.2 â€” Clique em "New Project"</p>
                        <ul class="mt-2 text-sm text-gray-600 space-y-1">
                            <li>â€¢ <strong>Name:</strong> <code class="bg-gray-100 px-1 rounded">clipwise</code></li>
                            <li>â€¢ <strong>Database Password:</strong> crie uma senha forte</li>
                            <li>â€¢ <strong>Region:</strong> East US (ou o mais perto)</li>
                        </ul>
                    </div>

                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <p class="font-medium text-gray-900">1.3 â€” Copie as chaves (Settings â†’ API)</p>
                        <p class="text-sm text-gray-500 mt-1">Depois de criar, vÃ¡ em <strong>Settings â†’ API</strong> e copie:</p>
                        <div class="mt-3 space-y-2">
                            <div>
                                <label class="text-xs text-gray-500">Project URL</label>
                                <input type="text" id="supabase-url" placeholder="https://xxx.supabase.co" class="w-full mt-1 px-3 py-2 border rounded-lg text-sm font-mono">
                            </div>
                            <div>
                                <label class="text-xs text-gray-500">anon / public key</label>
                                <input type="text" id="supabase-anon" placeholder="eyJhbGciOi..." class="w-full mt-1 px-3 py-2 border rounded-lg text-sm font-mono">
                            </div>
                            <div>
                                <label class="text-xs text-gray-500">service_role key (secret)</label>
                                <input type="text" id="supabase-service" placeholder="eyJhbGciOi..." class="w-full mt-1 px-3 py-2 border rounded-lg text-sm font-mono">
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <p class="font-medium text-gray-900">1.4 â€” Rode o SQL Schema</p>
                        <p class="text-sm text-gray-500 mt-1">VÃ¡ em <strong>SQL Editor â†’ New Query</strong>, cole o SQL abaixo e clique <strong>Run</strong>:</p>
                        <button onclick="copySchema()" class="copy-btn mt-2 bg-gray-900 text-white px-4 py-2 rounded-lg text-sm hover:bg-gray-800">
                            ðŸ“‹ Copiar SQL Schema
                        </button>
                        <span id="schema-copied" class="text-sm text-green-600 ml-2 hidden">Copiado!</span>
                    </div>
                </div>

                <button onclick="completeStep(1)" class="mt-6 bg-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-500">
                    âœ“ ConcluÃ­ este passo
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 2: Stripe -->
    <div class="step rounded-2xl border-2 border-gray-200 p-8 mb-6 opacity-60" id="step-2">
        <div class="flex items-start gap-4">
            <div class="step-number w-10 h-10 rounded-full bg-gray-400 text-white flex items-center justify-center font-bold flex-shrink-0">2</div>
            <div class="flex-1">
                <h2 class="text-xl font-bold text-gray-900">Configurar Stripe (Pagamentos)</h2>
                <p class="mt-1 text-gray-600">Para receber pagamentos dos clientes</p>

                <div class="mt-6 space-y-4">
                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <p class="font-medium text-gray-900">2.1 â€” Acesse o Stripe</p>
                        <a href="https://dashboard.stripe.com/register" target="_blank" class="mt-2 inline-block bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-500">
                            Criar conta Stripe â†’
                        </a>
                        <p class="text-xs text-gray-400 mt-1">JÃ¡ tem conta? <a href="https://dashboard.stripe.com/apikeys" target="_blank" class="text-indigo-500">Ir para API Keys</a></p>
                    </div>

                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <p class="font-medium text-gray-900">2.2 â€” Copie as chaves de teste</p>
                        <div class="mt-3 space-y-2">
                            <div>
                                <label class="text-xs text-gray-500">Publishable key (pk_test_...)</label>
                                <input type="text" id="stripe-pub" placeholder="pk_test_..." class="w-full mt-1 px-3 py-2 border rounded-lg text-sm font-mono">
                            </div>
                            <div>
                                <label class="text-xs text-gray-500">Secret key (sk_test_...)</label>
                                <input type="text" id="stripe-secret" placeholder="sk_test_..." class="w-full mt-1 px-3 py-2 border rounded-lg text-sm font-mono">
                            </div>
                        </div>
                    </div>
                </div>

                <button onclick="completeStep(2)" class="mt-6 bg-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-500">
                    âœ“ ConcluÃ­ este passo
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 3: Anthropic -->
    <div class="step rounded-2xl border-2 border-gray-200 p-8 mb-6 opacity-60" id="step-3">
        <div class="flex items-start gap-4">
            <div class="step-number w-10 h-10 rounded-full bg-gray-400 text-white flex items-center justify-center font-bold flex-shrink-0">3</div>
            <div class="flex-1">
                <h2 class="text-xl font-bold text-gray-900">Anthropic API Key (Resumos IA)</h2>
                <p class="mt-1 text-gray-600">Para gerar resumos inteligentes com Claude</p>

                <div class="mt-6 space-y-4">
                    <div class="bg-white rounded-xl p-4 border border-gray-200">
                        <a href="https://console.anthropic.com/settings/keys" target="_blank" class="inline-block bg-orange-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-orange-500">
                            Abrir Anthropic Console â†’
                        </a>
                        <div class="mt-3">
                            <label class="text-xs text-gray-500">API Key (sk-ant-...)</label>
                            <input type="text" id="anthropic-key" placeholder="sk-ant-api03-..." class="w-full mt-1 px-3 py-2 border rounded-lg text-sm font-mono">
                        </div>
                    </div>
                </div>

                <button onclick="completeStep(3)" class="mt-6 bg-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-500">
                    âœ“ ConcluÃ­ este passo
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 4: GitHub + Deploy -->
    <div class="step rounded-2xl border-2 border-gray-200 p-8 mb-6 opacity-60" id="step-4">
        <div class="flex items-start gap-4">
            <div class="step-number w-10 h-10 rounded-full bg-gray-400 text-white flex items-center justify-center font-bold flex-shrink-0">4</div>
            <div class="flex-1">
                <h2 class="text-xl font-bold text-gray-900">Rodar o Setup no Terminal</h2>
                <p class="mt-1 text-gray-600">Um comando faz tudo: instala, configura e faz deploy</p>

                <div class="mt-6 bg-gray-900 rounded-xl p-6 text-green-400 font-mono text-sm">
                    <p class="text-gray-500"># Abra o Terminal no Mac e rode:</p>
                    <p class="mt-2">cd ~/Downloads/clipwise</p>
                    <p>chmod +x setup.sh</p>
                    <p>./setup.sh</p>
                </div>
                <button onclick="copyTerminal()" class="copy-btn mt-3 bg-gray-900 text-white px-4 py-2 rounded-lg text-sm hover:bg-gray-800">
                    ðŸ“‹ Copiar comandos
                </button>

                <button onclick="completeStep(4)" class="mt-6 block bg-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-500">
                    âœ“ ConcluÃ­ este passo
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 5: Generate .env -->
    <div class="step rounded-2xl border-2 border-gray-200 p-8 mb-6 opacity-60" id="step-5">
        <div class="flex items-start gap-4">
            <div class="step-number w-10 h-10 rounded-full bg-gray-400 text-white flex items-center justify-center font-bold flex-shrink-0">5</div>
            <div class="flex-1">
                <h2 class="text-xl font-bold text-gray-900">Gerar arquivo .env.local</h2>
                <p class="mt-1 text-gray-600">Com base nas chaves que vocÃª colou acima</p>

                <button onclick="generateEnv()" class="mt-6 bg-green-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-green-500 text-lg">
                    ðŸš€ Gerar .env.local e Baixar
                </button>
                <p class="mt-2 text-sm text-gray-500">Coloque o arquivo na pasta do projeto antes de rodar o setup.sh</p>

                <button onclick="completeStep(5)" class="mt-6 block bg-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-500">
                    âœ“ Tudo pronto!
                </button>
            </div>
        </div>
    </div>

    <!-- Success -->
    <div id="success" class="hidden text-center py-12">
        <div class="text-6xl mb-4">ðŸŽ‰</div>
        <h2 class="text-3xl font-bold text-gray-900">ClipWise estÃ¡ no ar!</h2>
        <p class="mt-3 text-lg text-gray-500">Seu SaaS de transcriÃ§Ã£o de YouTube estÃ¡ funcionando.</p>
        <div class="mt-8 bg-green-50 rounded-2xl p-6 border border-green-200">
            <p class="font-semibold text-green-800">PrÃ³ximos passos:</p>
            <ul class="mt-3 text-left text-green-700 space-y-2 max-w-md mx-auto">
                <li>âœ“ Registrar domÃ­nio clipwise.ai</li>
                <li>âœ“ Conectar domÃ­nio no Vercel</li>
                <li>âœ“ Criar produtos no Stripe (Pro $9, Business $29)</li>
                <li>âœ“ Ativar Google OAuth no Supabase</li>
                <li>âœ“ Postar no Product Hunt / Twitter</li>
            </ul>
        </div>
    </div>
</div>

<script>
const SQL_SCHEMA = `-- ClipWise Database Schema
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  email TEXT NOT NULL,
  full_name TEXT,
  avatar_url TEXT,
  locale TEXT DEFAULT 'en',
  plan TEXT DEFAULT 'free' CHECK (plan IN ('free', 'pro', 'business', 'enterprise')),
  stripe_customer_id TEXT UNIQUE,
  stripe_subscription_id TEXT,
  subscription_status TEXT DEFAULT 'inactive',
  subscription_end_date TIMESTAMPTZ,
  credits_remaining INT DEFAULT 3,
  credits_reset_at TIMESTAMPTZ DEFAULT (NOW() + INTERVAL '30 days'),
  total_videos_processed INT DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE transcriptions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES profiles(id) ON DELETE CASCADE,
  video_id TEXT NOT NULL,
  video_url TEXT NOT NULL,
  title TEXT,
  channel_name TEXT,
  duration_seconds INT,
  thumbnail_url TEXT,
  transcript_text TEXT,
  transcript_timestamped TEXT,
  transcript_language TEXT,
  is_auto_generated BOOLEAN DEFAULT FALSE,
  word_count INT DEFAULT 0,
  summary TEXT,
  status TEXT DEFAULT 'pending',
  processing_time_ms INT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE payments (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES profiles(id) ON DELETE CASCADE,
  provider TEXT NOT NULL,
  provider_payment_id TEXT,
  amount_cents INT NOT NULL,
  currency TEXT DEFAULT 'USD',
  status TEXT DEFAULT 'pending',
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_transcriptions_user_id ON transcriptions(user_id);
CREATE INDEX idx_transcriptions_created_at ON transcriptions(created_at DESC);

ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE transcriptions ENABLE ROW LEVEL SECURITY;
ALTER TABLE payments ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own profile" ON profiles FOR SELECT USING (auth.uid() = id);
CREATE POLICY "Users can update own profile" ON profiles FOR UPDATE USING (auth.uid() = id);
CREATE POLICY "Users can view own transcriptions" ON transcriptions FOR SELECT USING (auth.uid() = user_id);
CREATE POLICY "Users can insert own transcriptions" ON transcriptions FOR INSERT WITH CHECK (auth.uid() = user_id);
CREATE POLICY "Users can view own payments" ON payments FOR SELECT USING (auth.uid() = user_id);

CREATE OR REPLACE FUNCTION handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO profiles (id, email, full_name, avatar_url)
  VALUES (NEW.id, NEW.email, NEW.raw_user_meta_data->>'full_name', NEW.raw_user_meta_data->>'avatar_url');
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION handle_new_user();`;

let completedSteps = 0;

function completeStep(n) {
    const step = document.getElementById('step-' + n);
    step.classList.remove('active');
    step.classList.add('done');
    step.querySelector('.step-number').style.background = '#22c55e';

    completedSteps = Math.max(completedSteps, n);

    // Activate next step
    const next = document.getElementById('step-' + (n + 1));
    if (next) {
        next.classList.add('active');
        next.classList.remove('opacity-60');
        next.querySelector('.step-number').style.background = '#9333ea';
        next.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // Update progress
    document.getElementById('progress-bar').style.width = (n * 20) + '%';
    document.getElementById('progress-text').textContent = n + '/5';

    if (n === 5) {
        document.getElementById('success').classList.remove('hidden');
        document.getElementById('progress-bar').style.width = '100%';
        document.getElementById('progress-text').textContent = '5/5 âœ“';
    }
}

function copySchema() {
    navigator.clipboard.writeText(SQL_SCHEMA);
    document.getElementById('schema-copied').classList.remove('hidden');
    setTimeout(() => document.getElementById('schema-copied').classList.add('hidden'), 2000);
}

function copyTerminal() {
    navigator.clipboard.writeText('cd ~/Downloads/clipwise && chmod +x setup.sh && ./setup.sh');
}

function generateEnv() {
    const env = `NEXT_PUBLIC_SUPABASE_URL=${document.getElementById('supabase-url')?.value || ''}
NEXT_PUBLIC_SUPABASE_ANON_KEY=${document.getElementById('supabase-anon')?.value || ''}
SUPABASE_SERVICE_ROLE_KEY=${document.getElementById('supabase-service')?.value || ''}

STRIPE_SECRET_KEY=${document.getElementById('stripe-secret')?.value || ''}
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=${document.getElementById('stripe-pub')?.value || ''}
STRIPE_WEBHOOK_SECRET=whsec_placeholder

ANTHROPIC_API_KEY=${document.getElementById('anthropic-key')?.value || ''}

NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_APP_NAME=ClipWise`;

    const blob = new Blob([env], { type: 'text/plain' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = '.env.local';
    a.click();
}
</script>

</body>
</html>
